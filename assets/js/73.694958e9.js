(window.webpackJsonp=window.webpackJsonp||[]).push([[73],{531:function(t,a,s){"use strict";s.r(a);var n=s(19),e=Object(n.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"version-21-3"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#version-21-3"}},[t._v("#")]),t._v(" Version 21.3")]),t._v(" "),s("p"),s("div",{staticClass:"table-of-contents"},[s("ul",[s("li",[s("a",{attrs:{href:"#introduction"}},[t._v("Introduction")])]),s("li",[s("a",{attrs:{href:"#what-to-know"}},[t._v("What to know")]),s("ul",[s("li",[s("a",{attrs:{href:"#python-3-7-only"}},[t._v("Python 3.7+ Only")])]),s("li",[s("a",{attrs:{href:"#streaming-as-first-class-citizen"}},[t._v("Streaming as first class citizen")])]),s("li",[s("a",{attrs:{href:"#router-overhaul"}},[t._v("Router overhaul")])]),s("li",[s("a",{attrs:{href:"#signals-api-‚≠êÔ∏è"}},[t._v("Signals API ‚≠êÔ∏è")])]),s("li",[s("a",{attrs:{href:"#route-naming"}},[t._v("Route naming")])]),s("li",[s("a",{attrs:{href:"#new-decorators"}},[t._v("New decorators")])]),s("li",[s("a",{attrs:{href:"#unquote-in-route"}},[t._v("Unquote in route")])]),s("li",[s("a",{attrs:{href:"#alter-request-match-info"}},[t._v("Alter Request.match_info")])]),s("li",[s("a",{attrs:{href:"#version-types-in-routes"}},[t._v("Version types in routes")])]),s("li",[s("a",{attrs:{href:"#safe-method-handling-with-body"}},[t._v("Safe method handling with body")])]),s("li",[s("a",{attrs:{href:"#application-blueprint-and-blueprint-group-parity"}},[t._v("Application, Blueprint and Blueprint Group parity")])]),s("li",[s("a",{attrs:{href:"#dropped-httpx-from-dependencies"}},[t._v("Dropped httpx from dependencies")])]),s("li",[s("a",{attrs:{href:"#removed-testing-library"}},[t._v("Removed testing library")])]),s("li",[s("a",{attrs:{href:"#application-and-connection-level-context-ctx-objects"}},[t._v("Application and connection level context (ctx) objects")])])])]),s("li",[s("a",{attrs:{href:"#news"}},[t._v("News")]),s("ul",[s("li",[s("a",{attrs:{href:"#a-new-frontpage-üéâ"}},[t._v("A NEW frontpage üéâ")])]),s("li",[s("a",{attrs:{href:"#chat-has-moved-to-discord"}},[t._v("Chat has moved to Discord")])]),s("li",[s("a",{attrs:{href:"#open-collective"}},[t._v("Open Collective")])]),s("li",[s("a",{attrs:{href:"#_2021-release-managers"}},[t._v("2021 Release Managers")])])])]),s("li",[s("a",{attrs:{href:"#thank-you"}},[t._v("Thank you")])])])]),s("p"),t._v(" "),s("h2",{attrs:{id:"introduction"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#introduction"}},[t._v("#")]),t._v(" Introduction")]),t._v(" "),s("p",[t._v("Sanic is now faster.")]),t._v(" "),s("p",[t._v("Well, it already was fast. But with the first iteration of the v21 release, we incorporated a few major milestones that have made some tangible improvements. These encompass some ideas that have been in the works for years, and have finally made it into the released version.")]),t._v(" "),s("div",{staticClass:"custom-block warning"},[s("p",{staticClass:"custom-block-title"},[t._v("Breaking changes")]),t._v(" "),s("p",[t._v("Version 21.3 introduces a lot of new features. But, it also includes some breaking changes. This is why these changes were introduced after the last LTS. If you rely upon something that has been removed, you should continue to use v20.12LTS until you are able to upgrade.")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("pip "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"sanic>=20.12,<20.13"')]),t._v("\npip freeze "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" requirements.txt\n")])])]),s("p",[t._v("For most typical installations, you should be able to upgrade without a problem.")])]),t._v(" "),s("h2",{attrs:{id:"what-to-know"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#what-to-know"}},[t._v("#")]),t._v(" What to know")]),t._v(" "),s("p",[t._v("Notable new or breaking features, and what to upgrade...")]),t._v(" "),s("h3",{attrs:{id:"python-3-7-only"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#python-3-7-only"}},[t._v("#")]),t._v(" Python 3.7+ Only")]),t._v(" "),s("p",[t._v("This version drops Python 3.6 support. Version 20.12LTS will continue to support Python 3.6 until its EOL in December, 2022, and version 19.12LTS will support it until its EOL in December, 2021.")]),t._v(" "),s("p",[t._v("Read more about our "),s("RouterLink",{attrs:{to:"/en/guide/project/policies.html#long-term-support-v-interim-releases"}},[t._v("LTS policy")]),t._v(".")],1),t._v(" "),s("h3",{attrs:{id:"streaming-as-first-class-citizen"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#streaming-as-first-class-citizen"}},[t._v("#")]),t._v(" Streaming as first class citizen")]),t._v(" "),s("p",[t._v("The biggest speed improvement came from unifying the request/response cycle into a single flow. Previously, there was a difference between regular cycles, and streaming cycles. This has been simplified under the hood, even though the API is staying the same right now for compatibility. The net benefit is that "),s("strong",[t._v("all")]),t._v(" requests now should see a new benefit.")]),t._v(" "),s("p",[t._v("Read more about "),s("RouterLink",{attrs:{to:"/en/guide/advanced/streaming.html#response-streaming"}},[t._v("streaming changes")]),t._v(".")],1),t._v(" "),s("h3",{attrs:{id:"router-overhaul"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#router-overhaul"}},[t._v("#")]),t._v(" Router overhaul")]),t._v(" "),s("p",[t._v("The old Sanic router was based upon regular expressions. In addition it suffered from a number of quirks that made it hard to modify at run time, and resulted in some performance issues. This change has been years in the making and now "),s("a",{attrs:{href:"https://community.sanicframework.org/t/a-fast-new-router/649/41",target:"_blank",rel:"noopener noreferrer"}},[t._v("converts the router to a compiled tree at startup"),s("OutboundLink")],1),t._v(". Look for additional improvements throughout the year.")]),t._v(" "),s("p",[t._v("The outward facing API has kept backwards compatibility. However, if you were accessing anything inside the router specifically, you many notice some changes. For example:")]),t._v(" "),s("ol",[s("li",[s("code",[t._v("Router.get()")]),t._v(" has a new return value")]),t._v(" "),s("li",[s("code",[t._v("Route")]),t._v(" is now a proper class object and not a "),s("code",[t._v("namedtuple")])]),t._v(" "),s("li",[t._v("If building the router manually, you will need to call "),s("code",[t._v("Router.finalize()")]),t._v(" before it is usable")]),t._v(" "),s("li",[t._v("There is a new "),s("code",[t._v("<date:ymd>")]),t._v(" pattern that can be matched in your routes")]),t._v(" "),s("li",[t._v("You cannot startup an application without at least one route defined")])]),t._v(" "),s("p",[t._v("The router is now located in its own repository: "),s("a",{attrs:{href:"https://github.com/sanic-org/sanic-router",target:"_blank",rel:"noopener noreferrer"}},[t._v("sanic-org/sanic-router"),s("OutboundLink")],1),t._v(" and is also its own "),s("a",{attrs:{href:"https://pypi.org/project/sanic-routing/",target:"_blank",rel:"noopener noreferrer"}},[t._v("standalone package on PyPI"),s("OutboundLink")],1),t._v(".")]),t._v(" "),s("h3",{attrs:{id:"signals-api-‚≠êÔ∏è"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#signals-api-‚≠êÔ∏è"}},[t._v("#")]),t._v(" Signals API ‚≠êÔ∏è")]),t._v(" "),s("p",[s("em",[t._v("BETA Feature: API to be finalized in v21.6")])]),t._v(" "),s("p",[t._v("A side benefit of the new router is that it can do double duty also powering the "),s("a",{attrs:{href:"https://github.com/sanic-org/sanic/issues/1630",target:"_blank",rel:"noopener noreferrer"}},[t._v("new signals API"),s("OutboundLink")],1),t._v(". This feature is being released for public usage now, and likely the public API will not change in its final form.")]),t._v(" "),s("p",[t._v("The core ideas of this feature are:")]),t._v(" "),s("ol",[s("li",[t._v("to allow the developer greater control and access to plugging into the server and request lifecycles,")]),t._v(" "),s("li",[t._v("to provide new tools to synchronize and send messages through your application, and")]),t._v(" "),s("li",[t._v("to ultimately further increase performance.")])]),t._v(" "),s("p",[t._v("The API introduces three new methods:")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("@app.signal(...)")]),t._v(" - For defining a signal handler. It looks and operates very much like a route. Whenever that signal is dispatched, this handler will be executed.")]),t._v(" "),s("li",[s("code",[t._v("app.event(...)")]),t._v(" - An awaitable that can be used anywhere in your application to pause execution until the event is triggered.")]),t._v(" "),s("li",[s("code",[t._v("app.dispatch(...)")]),t._v(" - Trigger an event and cause the signal handlers to execute.")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token decorator annotation punctuation"}},[t._v("@app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("signal")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"foo.bar.<thing>"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("signal_handler")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("thing"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("**")]),t._v("kwargs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string-interpolation"}},[s("span",{pre:!0,attrs:{class:"token string"}},[t._v('f"[signal_handler] ')]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("thing"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" kwargs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("wait_for_event")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("while")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"> waiting"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("event"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"foo.bar.*"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"> event found\\n"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token decorator annotation punctuation"}},[t._v("@app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("after_server_start")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("after_server_start")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" loop"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("add_task"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("wait_for_event"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token decorator annotation punctuation"}},[t._v("@app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("get")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("trigger")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("request"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dispatch"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"foo.bar.baz"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" response"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("text"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Done."')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])])]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token decorator annotation punctuation"}},[t._v("@app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("signal")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"foo.bar.<thing>"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("signal_handler")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("thing"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("**")]),t._v("kwargs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string-interpolation"}},[s("span",{pre:!0,attrs:{class:"token string"}},[t._v('f"[signal_handler] ')]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("thing"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" kwargs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("wait_for_event")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("while")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"> waiting"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("event"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"foo.bar.*"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"> event found\\n"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token decorator annotation punctuation"}},[t._v("@app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("after_server_start")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("after_server_start")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" loop"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("add_task"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("wait_for_event"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token decorator annotation punctuation"}},[t._v("@app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("get")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("trigger")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("request"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dispatch"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"foo.bar.baz"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" response"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("text"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Done."')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("h3",{attrs:{id:"route-naming"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#route-naming"}},[t._v("#")]),t._v(" Route naming")]),t._v(" "),s("p",[t._v("Routes used to be referenced by both "),s("code",[t._v("route.name")]),t._v(" and "),s("code",[t._v("route.endpoint")]),t._v(". While similar, they were slightly different. Now, all routes will be "),s("strong",[t._v("consistently")]),t._v(" namespaced and referenced.")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("<app name>.[optional:<blueprint name>.]<handler name>\n")])])]),s("p",[t._v('This new "name" is assigned to the property '),s("code",[t._v("route.name")]),t._v(". We are deprecating "),s("code",[t._v("route.endpoint")]),t._v(", and will remove that property in v21.9. Until then, it will be an alias for "),s("code",[t._v("route.name")]),t._v(".")]),t._v(" "),s("p",[t._v("In addition, naming prefixes that had been in use for things like static, websocket, and blueprint routes have been removed.")]),t._v(" "),s("h3",{attrs:{id:"new-decorators"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#new-decorators"}},[t._v("#")]),t._v(" New decorators")]),t._v(" "),s("p",[t._v("Several new convenience decorators to help IDEs with autocomplete.")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# Alias to @app.listener("...")')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token decorator annotation punctuation"}},[t._v("@app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("before_server_start")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token decorator annotation punctuation"}},[t._v("@app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("after_server_stop")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token decorator annotation punctuation"}},[t._v("@app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("before_server_start")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token decorator annotation punctuation"}},[t._v("@app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("after_server_stop")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# Alias to @app.middleware("...")')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token decorator annotation punctuation"}},[t._v("@app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("on_request")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token decorator annotation punctuation"}},[t._v("@app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("on_response")]),t._v("\n")])])]),s("h3",{attrs:{id:"unquote-in-route"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#unquote-in-route"}},[t._v("#")]),t._v(" Unquote in route")]),t._v(" "),s("p",[t._v("If you have a route that uses non-ascii characters, Sanic will no longer "),s("code",[t._v("unquote")]),t._v(" the text for you. You will need to specifically tell the route definition that it should do so.")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token decorator annotation punctuation"}},[t._v("@app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("route")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/overload/<param>"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" methods"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"GET"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" unquote"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("handler2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("request"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" param"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" text"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"OK2 "')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" param"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\nrequest"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" response "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("test_client"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("get"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/overload/ÊÇ®Â•Ω"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("assert")]),t._v(" response"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("text "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"OK2 ÊÇ®Â•Ω"')]),t._v("\n")])])]),s("p",[t._v("If you forget to do so, your text will remain encoded.")]),t._v(" "),s("h3",{attrs:{id:"alter-request-match-info"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#alter-request-match-info"}},[t._v("#")]),t._v(" Alter "),s("code",[t._v("Request.match_info")])]),t._v(" "),s("p",[t._v("The "),s("code",[t._v("match_info")]),t._v(" has always provided the data for the matched path parameters. You now have access to modify that, for example in middleware.")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token decorator annotation punctuation"}},[t._v("@app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("on_request")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("convert_to_snake_case")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("request"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    request"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("match_info "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" to_snake"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("request"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("match_info"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("h3",{attrs:{id:"version-types-in-routes"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#version-types-in-routes"}},[t._v("#")]),t._v(" Version types in routes")]),t._v(" "),s("p",[t._v("The "),s("code",[t._v("version")]),t._v(" argument in routes can now be:")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("str")])]),t._v(" "),s("li",[s("code",[t._v("int")])]),t._v(" "),s("li",[s("code",[t._v("float")])]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token decorator annotation punctuation"}},[t._v("@app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("route")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/foo"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" version"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"2.1.1"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token decorator annotation punctuation"}},[t._v("@app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("route")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/foo"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" version"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token decorator annotation punctuation"}},[t._v("@app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("route")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/foo"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" version"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2.1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])])]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token decorator annotation punctuation"}},[t._v("@app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("route")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/foo"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" version"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"2.1.1"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token decorator annotation punctuation"}},[t._v("@app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("route")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/foo"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" version"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token decorator annotation punctuation"}},[t._v("@app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("route")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/foo"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" version"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2.1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("h3",{attrs:{id:"safe-method-handling-with-body"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#safe-method-handling-with-body"}},[t._v("#")]),t._v(" Safe method handling with body")]),t._v(" "),s("p",[t._v("Route handlers for "),s("code",[t._v("GET")]),t._v(", "),s("code",[t._v("HEAD")]),t._v(", "),s("code",[t._v("OPTIONS")]),t._v(" and "),s("code",[t._v("DELETE")]),t._v(" will not decode any HTTP body passed to it. You can override this:")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token decorator annotation punctuation"}},[t._v("@app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("delete")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" ignore_body"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("False")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("h3",{attrs:{id:"application-blueprint-and-blueprint-group-parity"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#application-blueprint-and-blueprint-group-parity"}},[t._v("#")]),t._v(" Application, Blueprint and Blueprint Group parity")]),t._v(" "),s("p",[t._v("The "),s("code",[t._v("Sanic")]),t._v(" and "),s("code",[t._v("Blueprint")]),t._v(" classes share a common base. Previously they duplicated a lot of functionality, that lead to slightly different implementations between them. Now that they both inherit the same base class, developers and plugins should have a more consistent API to work with.")]),t._v(" "),s("p",[t._v("Also, Blueprint Groups now also support common URL extensions like the "),s("code",[t._v("version")]),t._v(" and "),s("code",[t._v("strict_slashes")]),t._v(" keyword arguments.")]),t._v(" "),s("h3",{attrs:{id:"dropped-httpx-from-dependencies"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#dropped-httpx-from-dependencies"}},[t._v("#")]),t._v(" Dropped "),s("code",[t._v("httpx")]),t._v(" from dependencies")]),t._v(" "),s("p",[t._v("There is no longer a dependency on "),s("code",[t._v("httpx")]),t._v(".")]),t._v(" "),s("h3",{attrs:{id:"removed-testing-library"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#removed-testing-library"}},[t._v("#")]),t._v(" Removed "),s("code",[t._v("testing")]),t._v(" library")]),t._v(" "),s("p",[t._v("Sanic internal testing client has been removed. It is now located in its own repository: "),s("a",{attrs:{href:"https://github.com/sanic-org/sanic-testing",target:"_blank",rel:"noopener noreferrer"}},[t._v("sanic-org/sanic-testing"),s("OutboundLink")],1),t._v(" and is also its own "),s("a",{attrs:{href:"https://pypi.org/project/sanic-testing/",target:"_blank",rel:"noopener noreferrer"}},[t._v("standalone package on PyPI"),s("OutboundLink")],1),t._v(".")]),t._v(" "),s("p",[t._v("If you have "),s("code",[t._v("sanic-testing")]),t._v(" installed, it will be available and usable on your "),s("code",[t._v("Sanic()")]),t._v(" application instances as before. So, the "),s("strong",[t._v("only")]),t._v(" change you will need to make is to add "),s("code",[t._v("sanic-testing")]),t._v(" to your test suite requirements.")]),t._v(" "),s("h3",{attrs:{id:"application-and-connection-level-context-ctx-objects"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#application-and-connection-level-context-ctx-objects"}},[t._v("#")]),t._v(" Application and connection level context ("),s("code",[t._v("ctx")]),t._v(") objects")]),t._v(" "),s("p",[t._v("Version 19.9 "),s("a",{attrs:{href:"https://github.com/sanic-org/sanic/pull/1666/files",target:"_blank",rel:"noopener noreferrer"}},[t._v("added "),s("OutboundLink")],1),t._v(" the "),s("code",[t._v("request.ctx")]),t._v(" API. This helpful construct easily allows for attaching properties and data to a request object (for example, in middleware), and reusing the information elsewhere int he application.")]),t._v(" "),s("p",[t._v("Similarly, this concept is being extended in two places:")]),t._v(" "),s("ol",[s("li",[t._v("the application instance, and")]),t._v(" "),s("li",[t._v("a transport connection.")])]),t._v(" "),s("h4",{attrs:{id:"application-context"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#application-context"}},[t._v("#")]),t._v(" Application context")]),t._v(" "),s("p",[t._v("A common use case is to attach properties to the app instance. For the sake of consistency, and to avoid the issue of name collision with Sanic properties, the "),s("code",[t._v("ctx")]),t._v(" object now exists on "),s("code",[t._v("Sanic")]),t._v(" instances.")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token decorator annotation punctuation"}},[t._v("@app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("before_server_startup")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("startup_db")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" _"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# WRONG")]),t._v("\n    app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("db "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" connect_to_db"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# CORRECT")]),t._v("\n    app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ctx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("db "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" connect_to_db"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("h4",{attrs:{id:"connection-context"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#connection-context"}},[t._v("#")]),t._v(" Connection context")]),t._v(" "),s("p",[t._v("When a client sends a keep alive header, Sanic will attempt to keep the transport socket "),s("RouterLink",{attrs:{to:"/en/guide/deployment/configuration.html#keep-alive-timeout"}},[t._v("open for a period of time")]),t._v(". That transport object now has a "),s("code",[t._v("ctx")]),t._v(" object available on it. This effectively means that multiple requests from a single client (where the transport layer is being reused) may share state.")],1),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token decorator annotation punctuation"}},[t._v("@app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("on_request")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("increment_foo")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("request"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("not")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("hasattr")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("request"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("conn_info"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ctx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"foo"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        request"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("conn_info"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ctx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("foo "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n    request"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("conn_info"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ctx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("foo "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token decorator annotation punctuation"}},[t._v("@app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("get")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("count_foo")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("request"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" text"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string-interpolation"}},[s("span",{pre:!0,attrs:{class:"token string"}},[t._v('f"request.conn_info.ctx.foo=')]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("request"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("conn_info"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ctx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("foo"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("$ "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" localhost:8000 localhost:8000 localhost:8000\nrequest.conn_info.ctx.foo"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\nrequest.conn_info.ctx.foo"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("\nrequest.conn_info.ctx.foo"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v("\n")])])]),s("div",{staticClass:"custom-block warning"},[s("p",{staticClass:"custom-block-title"},[t._v("WARNING")]),t._v(" "),s("p",[t._v("Connection level context is an experimental feature, and should be finalized in v21.6.")])]),t._v(" "),s("h2",{attrs:{id:"news"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#news"}},[t._v("#")]),t._v(" News")]),t._v(" "),s("h3",{attrs:{id:"a-new-frontpage-üéâ"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#a-new-frontpage-üéâ"}},[t._v("#")]),t._v(" A NEW frontpage üéâ")]),t._v(" "),s("p",[t._v('We have split the documentation into two. The docstrings inside the codebase will still continue to build sphinx docs to ReadTheDocs. However, it will be limited to API documentation. The new frontpage will house the "Sanic User Guide".')]),t._v(" "),s("p",[t._v("The new site runs on Vuepress. Contributions are welcome. We also invite help in translating the documents.")]),t._v(" "),s("p",[t._v("As a part of this, we also freshened up the RTD documentation and changed it to API docs only.")]),t._v(" "),s("h3",{attrs:{id:"chat-has-moved-to-discord"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#chat-has-moved-to-discord"}},[t._v("#")]),t._v(" Chat has moved to Discord")]),t._v(" "),s("p",[t._v("The Gitter chatroom has taken one step closer to being phased out. In its place we opened a "),s("a",{attrs:{href:"https://discord.gg/FARQzAEMAA",target:"_blank",rel:"noopener noreferrer"}},[t._v("Discord server"),s("OutboundLink")],1),t._v(".")]),t._v(" "),s("h3",{attrs:{id:"open-collective"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#open-collective"}},[t._v("#")]),t._v(" Open Collective")]),t._v(" "),s("p",[t._v("The Sanic Community Organization has "),s("a",{attrs:{href:"https://opencollective.com/sanic-org",target:"_blank",rel:"noopener noreferrer"}},[t._v("opened a page on Open Collective"),s("OutboundLink")],1),t._v(" to enable anyone that would like to financially support the development of Sanic.")]),t._v(" "),s("h3",{attrs:{id:"_2021-release-managers"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2021-release-managers"}},[t._v("#")]),t._v(" 2021 Release Managers")]),t._v(" "),s("p",[t._v("Thank you to @sjsadowski and @yunstanford for acting as release managers for both 2019 and 2020. This year's release managers are @ahopkins and @vltr.")]),t._v(" "),s("h2",{attrs:{id:"thank-you"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#thank-you"}},[t._v("#")]),t._v(" Thank you")]),t._v(" "),s("p",[t._v("Thank you to everyone that participated in this release: üëè")]),t._v(" "),s("p",[s("a",{attrs:{href:"https://github.com/ahopkins",target:"_blank",rel:"noopener noreferrer"}},[t._v("@ahopkins"),s("OutboundLink")],1),t._v(" "),s("a",{attrs:{href:"https://github.com/akshgpt7",target:"_blank",rel:"noopener noreferrer"}},[t._v("@akshgpt7"),s("OutboundLink")],1),t._v(" "),s("a",{attrs:{href:"https://github.com/artcg",target:"_blank",rel:"noopener noreferrer"}},[t._v("@artcg"),s("OutboundLink")],1),t._v(" "),s("a",{attrs:{href:"https://github.com/ashleysommer",target:"_blank",rel:"noopener noreferrer"}},[t._v("@ashleysommer"),s("OutboundLink")],1),t._v(" "),s("a",{attrs:{href:"https://github.com/elis-k",target:"_blank",rel:"noopener noreferrer"}},[t._v("@elis-k"),s("OutboundLink")],1),t._v(" "),s("a",{attrs:{href:"https://github.com/harshanarayana",target:"_blank",rel:"noopener noreferrer"}},[t._v("@harshanarayana"),s("OutboundLink")],1),t._v(" "),s("a",{attrs:{href:"https://github.com/sjsadowski",target:"_blank",rel:"noopener noreferrer"}},[t._v("@sjsadowski"),s("OutboundLink")],1),t._v(" "),s("a",{attrs:{href:"https://github.com/tronic",target:"_blank",rel:"noopener noreferrer"}},[t._v("@tronic"),s("OutboundLink")],1),t._v(" "),s("a",{attrs:{href:"https://github.com/vltr",target:"_blank",rel:"noopener noreferrer"}},[t._v("@vltr"),s("OutboundLink")],1),t._v(",")]),t._v(" "),s("p",[t._v("To "),s("a",{attrs:{href:"https://github.com/miss85246",target:"_blank",rel:"noopener noreferrer"}},[t._v("@ConnorZhang"),s("OutboundLink")],1),t._v(" and "),s("a",{attrs:{href:"https://github.com/ZinkLu",target:"_blank",rel:"noopener noreferrer"}},[t._v("@ZinkLu"),s("OutboundLink")],1),t._v(" for translating our documents into Chinese,")]),t._v(" "),s("hr"),t._v(" "),s("p",[t._v("Make sure to checkout the changelog to get links to all the PRs, etc.")])])}),[],!1,null,null,null);a.default=e.exports}}]);